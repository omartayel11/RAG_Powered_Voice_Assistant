# from sentence_transformers import SentenceTransformer
# import chromadb
# from chromadb.utils import embedding_functions

# # Initialize the model and embedding function
# model_name = "akhooli/Arabic-SBERT-100K"
# sentence_transformer_ef = embedding_functions.SentenceTransformerEmbeddingFunction(model_name=model_name)
# client = chromadb.Client()

# # Create or get the collection with the custom embedding function
# collection = client.create_collection(
#     name="recipestest",
#     embedding_function=sentence_transformer_ef,
#     metadata={"hnsw:space": "cosine"}
# )
# print("Collection created or already exists:", collection.name)

# recipes_data = [
#     ("شوربة الحريرة", 
#  "الحريرة شوربة مغربية في رمضان. والحريرة رغم إنها أصلها مغربي، إلا إنها انتشرت في كل العالم العربي وأصبحت من الأطباق المفضلة، خصوصًا في شهر رمضان.",
#  "كيلو مكعبات لحمة غنم من غير عظم ودهن، معلقة صغيرة كركم، معلقة صغيرة فلفل أسود مطحون، معلقة صغيرة قرفة مطحونة، معلقة صغيرة زنجبيل بودرة، معلقة صغيرة فلفل أحمر حار مطحون، معلاقتين سمنة أو زبدة، كوبين كرفس، بصلة مفرومة، بصلة حمراء مفرومة، كوب كزبرة خضراء مفرومة، خمس طماطم متوسطة الحجم، سبع أكواب مية، كوبين عدس أخضر، علبة حمص (٣٧٥ جرام) مصفاة من مياها، مية جرام معكرونة عيدان رفيعة زي الشعيرية، بيضتين، عصير ليمونة.",
#  "في حلة كبيرة، حط اللحمة مع الكركم والفلفل الأسود والقرفة والزنجبيل والفلفل الأحمر والسمنة والكرفس والبصل والكزبرة وقلبيهم مع بعض على نار هادية لغاية ما يستووا شوية. قشري الطماطم وقطعيها مكعبات كبيرة وحطيها مع الخليط وسيبي الحلة على نار هادية لغاية ما تستوي الطماطم لمدة حوالي ١٥ دقيقة. ضيفي الميه والعدس واتركيهم يغلو على نار عالية، بعد ما يغلو، وطي النار وغطي الحلة وسيبيها على نار هادية لمدة ساعتين. قبل ما تخلص الشوربة بـ١٠ دقايق، زودي الحرارة شوية علشان تبقى متوسطة، ضيفي الحمص والمعكرونة وسيبيهم على النار لـ١٠ دقايق لغاية ما المعكرونة تستوي. ضيفي عصير الليمون والبيض، سيبيهم على النار لدقيقتين علشان البيض يستوي وبعدين ارفعي الشوربة وقدميها.",
#  "شوربة", "recipe_1"),

#     ("شوربة البطاطا والسبانخ", 
#  "رغم إن كتير من الناس ما تعودوش يستخدموا السبانخ غير في طهي السبانخ أو في الفطائر، إلا إن الشوربة دي طريقة لذيذة جدًا لاستخدام السبانخ وهي كمان مفيدة جدًا.",
#  "معلاقتين زيت زيتون، بصلة متوسطة مقشرة ومفرومة، فص ثوم مبشور ناعم أو مدقوق، معلقة صغيرة من أوراق الزعتر المجفف، ٤٠٠ جرام بطاطا مقشرة ومفرومة خشن، ٤ أكواب مرقة دجاج، حزمة سبانخ، نص كوب مسحوق حليب، عصير نص ليمونة، حبيتين كراث كبيرين (اختياري).",
#  "يسخن الزيت في حلة كبيرة، ويحطوا البصل وبعدها الثوم والزعتر. تغطي الحلة وتسيبيها تتحمر على نار هادية لمدة ٣-٤ دقايق مع التقليب من وقت للتاني. اغسلي الكراث واتخلصي من الأوراق القاسية وقطعي الجزء الأبيض والأخضر لشرائح. ضيفي الكراث مع البطاطا للخليط بتاع البصل. غطي الحلة واتركيها على النار ٣-٤ دقايق تانيين مع التقليب مرة أو مرتين. ضيفي مرقة الدجاج واتركي الحلة على النار لغاية ما تغلي. وطي النار واتركيها على نار هادية لمدة ٢٠ دقيقة أو لغاية ما البطاطا تستوي. ضيفي السبانخ واتركي الحلة على النار تاني ٣-٤ دقايق. اضربي الخليط في الخلاط الكهربائي على دفعات. ضيفي مسحوق الحليب للخليط. قدمي الحساء وهو سخن أو سيبيه يبرد. قبل التقديم مباشرة، اعصري شوية ليمون حامض فوق كل طبق.",
#  "شوربة", "recipe_2"),

#     ("شوربة البصل", 
#  "شوربة البصل هي طبق شهي وسهل التحضير، بنعملها باستخدام البصل والزبدة والمرقة، وبتضاف ليها التوابل علشان تدي نكهة مميزة.",
#  "٥٠ جرام زبدة، معلاقتين طعام زيت زيتون، ٦ بصيلات متوسطة الحجم، مقشرة ومقطعة شرائح رفيعة، معلقة كبيرة سكر، ٤ أكواب مرقة لحمة، ملح وفلفل أسود، شوية خل (حسب الرغبة).",
#  "يسخن الزيت أو الزبدة في الحلة. ضيفي شرائح البصل وحركيهم على نار هادية بين كل فترة والتانية لغاية ما البصل يذبل ويكون لونه أصفر (من ٢٠ لـ ٢٥ دقيقة). رشي السكر على البصل مع الاستمرار في التقليب لمدة ٥ دقايق. ضيفي مرقة اللحم وبعد كده ضيفي الخل والملح والفلفل الأسود وسيبيهم يغلو لمدة ١٥ دقيقة. قدمي الشوربة مع شرائح الخبز الفرنسي المحمص. علشان تعملي شرائح الخبز الفرنسي المحمص، قطعي رغيف خبز فرنسي لشرائح سميكة شوية ورشي عليها جبن مبشور وحطيها تحت الشواية لغاية ما الجبن يسيح.",
#  "شوربة", "recipe_3"),

#     ("شوربة الفراخ", 
#  "شوربة الفراخ هي طبق لذيذ ومغذي، بنعملها باستخدام صدور الفراخ والمعكرونة، وبنضيف ليها التوابل علشان تدينا نكهة مميزة.",
#  "قطع من صدور الفراخ، رأس بصلة، فص ثوم، نصف باكيت معكرونة، كوب ونصف مية، سمنة.",
#  "نحط السمنة في إناء التحضير لغاية ما تذوب وبعد كده نضيف عليها البصل ونقلب لغاية ما يحمر. نضيف قطع الفراخ المقطعة مكعبات ونستمر في التقليب. نضيف الثوم المدقوق والمعكرونة مع التقليب. بعد كده نصب عليهم المية ونسيبهم لغاية ما يستووا لمدة ١٥ دقيقة.",
#  "شوربة", "recipe_4"),

#     ("فراخ بالبصل", 
#  "فراخ بالبصل هو طبق لذيذ وشهي، بنعمله باستخدام الفراخ والبصل والتوابل علشان يدينا نكهة مميزة.",
#  "فراخة واحدة، ٣ بصيلات متوسطة الحجم، ٣ معالق كبيرة سمنة، خلاصة مرقة فراخ، بهارات حسب الرغبة.",
#  "نقطع الفراخة قطع صغيرة ونتأكد إنها مغسولة كويس، وبعد كده نحطها في إناء الطبخ. نبشر البصل على الفراخ، ونضيف عليها السمنة، ونقلب كويس على النار وبعد كده نضيف عليها البهارات ومرقة الفراخ، ونقلب من وقت للتاني، لغاية ما البصل يوصل للون الذهبي، لمدة ١٥ دقيقة تقريبًا. نضيف ٤ أكواب مية على الفراخ ونسيبها تغلي لمدة نص ساعة لغاية ما القوام يتماسك. نقدمها مع طبق أرز أبيض وبالهناء والشفاء.",
#  "اكلات رئيسية", "recipe_5")
# ]

# # Insert the whole recipe as a single chunk
# for doc in recipes_data:
#     full_recipe = f"{doc[0]}\n{doc[1]}\n{doc[2]}\n{doc[3]}"
#     collection.upsert(
#         documents=[full_recipe],  # Full recipe as a single chunk
#         ids=[f"{doc[5]}_full_recipe"],
#         metadatas=[{"type": "recipe", "category": doc[4]}]  # Metadata for the full recipe
#     )

# print("Data has been successfully added to the 'recipes' collection.")







import chromadb
from sentence_transformers import SentenceTransformer
from chromadb.utils import embedding_functions

# Initialize the model and embedding function
model_name = "akhooli/Arabic-SBERT-100K"
sentence_transformer_ef = embedding_functions.SentenceTransformerEmbeddingFunction(model_name=model_name)

# Connect to the ChromaDB server using the HttpClient
chroma_client = chromadb.HttpClient(host='localhost', port=8000)

# Create or get the collection with the custom embedding function
collection = chroma_client.create_collection(
    name="recipestest",
    embedding_function=sentence_transformer_ef,
    metadata={"hnsw:space": "cosine"}
)
print("Collection created or already exists:", collection.name)

recipes_data = [
    ("شوربة الحريرة", 
 "الحريرة شوربة مغربية في رمضان. والحريرة رغم إنها أصلها مغربي، إلا إنها انتشرت في كل العالم العربي وأصبحت من الأطباق المفضلة، خصوصًا في شهر رمضان.",
 "كيلو مكعبات لحمة غنم من غير عظم ودهن، معلقة صغيرة كركم، معلقة صغيرة فلفل أسود مطحون، معلقة صغيرة قرفة مطحونة، معلقة صغيرة زنجبيل بودرة، معلقة صغيرة فلفل أحمر حار مطحون، معلاقتين سمنة أو زبدة، كوبين كرفس، بصلة مفرومة، بصلة حمراء مفرومة، كوب كزبرة خضراء مفرومة، خمس طماطم متوسطة الحجم، سبع أكواب مية، كوبين عدس أخضر، علبة حمص (٣٧٥ جرام) مصفاة من مياها، مية جرام معكرونة عيدان رفيعة زي الشعيرية، بيضتين، عصير ليمونة.",
 "في حلة كبيرة، حط اللحمة مع الكركم والفلفل الأسود والقرفة والزنجبيل والفلفل الأحمر والسمنة والكرفس والبصل والكزبرة وقلبيهم مع بعض على نار هادية لغاية ما يستووا شوية. قشري الطماطم وقطعيها مكعبات كبيرة وحطيها مع الخليط وسيبي الحلة على نار هادية لغاية ما تستوي الطماطم لمدة حوالي ١٥ دقيقة. ضيفي الميه والعدس واتركيهم يغلو على نار عالية، بعد ما يغلو، وطي النار وغطي الحلة وسيبيها على نار هادية لمدة ساعتين. قبل ما تخلص الشوربة بـ١٠ دقايق، زودي الحرارة شوية علشان تبقى متوسطة، ضيفي الحمص والمعكرونة وسيبيهم على النار لـ١٠ دقايق لغاية ما المعكرونة تستوي. ضيفي عصير الليمون والبيض، سيبيهم على النار لدقيقتين علشان البيض يستوي وبعدين ارفعي الشوربة وقدميها.",
 "شوربة", "recipe_1"),

    ("شوربة البطاطا والسبانخ", 
 "رغم إن كتير من الناس ما تعودوش يستخدموا السبانخ غير في طهي السبانخ أو في الفطائر، إلا إن الشوربة دي طريقة لذيذة جدًا لاستخدام السبانخ وهي كمان مفيدة جدًا.",
 "معلاقتين زيت زيتون، بصلة متوسطة مقشرة ومفرومة، فص ثوم مبشور ناعم أو مدقوق، معلقة صغيرة من أوراق الزعتر المجفف، ٤٠٠ جرام بطاطا مقشرة ومفرومة خشن، ٤ أكواب مرقة دجاج، حزمة سبانخ، نص كوب مسحوق حليب، عصير نص ليمونة، حبيتين كراث كبيرين (اختياري).",
 "يسخن الزيت في حلة كبيرة، ويحطوا البصل وبعدها الثوم والزعتر. تغطي الحلة وتسيبيها تتحمر على نار هادية لمدة ٣-٤ دقايق مع التقليب من وقت للتاني. اغسلي الكراث واتخلصي من الأوراق القاسية وقطعي الجزء الأبيض والأخضر لشرائح. ضيفي الكراث مع البطاطا للخليط بتاع البصل. غطي الحلة واتركيها على النار ٣-٤ دقايق تانيين مع التقليب مرة أو مرتين. ضيفي مرقة الدجاج واتركي الحلة على النار لغاية ما تغلي. وطي النار واتركيها على نار هادية لمدة ٢٠ دقيقة أو لغاية ما البطاطا تستوي. ضيفي السبانخ واتركي الحلة على النار تاني ٣-٤ دقايق. اضربي الخليط في الخلاط الكهربائي على دفعات. ضيفي مسحوق الحليب للخليط. قدمي الحساء وهو سخن أو سيبيه يبرد. قبل التقديم مباشرة، اعصري شوية ليمون حامض فوق كل طبق.",
 "شوربة", "recipe_2"),

    ("شوربة البصل", 
 "شوربة البصل هي طبق شهي وسهل التحضير، بنعملها باستخدام البصل والزبدة والمرقة، وبتضاف ليها التوابل علشان تدي نكهة مميزة.",
 "٥٠ جرام زبدة، معلاقتين طعام زيت زيتون، ٦ بصيلات متوسطة الحجم، مقشرة ومقطعة شرائح رفيعة، معلقة كبيرة سكر، ٤ أكواب مرقة لحمة، ملح وفلفل أسود، شوية خل (حسب الرغبة).",
 "يسخن الزيت أو الزبدة في الحلة. ضيفي شرائح البصل وحركيهم على نار هادية بين كل فترة والتانية لغاية ما البصل يذبل ويكون لونه أصفر (من ٢٠ لـ ٢٥ دقيقة). رشي السكر على البصل مع الاستمرار في التقليب لمدة ٥ دقايق. ضيفي مرقة اللحم وبعد كده ضيفي الخل والملح والفلفل الأسود وسيبيهم يغلو لمدة ١٥ دقيقة. قدمي الشوربة مع شرائح الخبز الفرنسي المحمص. علشان تعملي شرائح الخبز الفرنسي المحمص، قطعي رغيف خبز فرنسي لشرائح سميكة شوية ورشي عليها جبن مبشور وحطيها تحت الشواية لغاية ما الجبن يسيح.",
 "شوربة", "recipe_3"),

    ("شوربة الفراخ", 
 "شوربة الفراخ هي طبق لذيذ ومغذي، بنعملها باستخدام صدور الفراخ والمعكرونة، وبنضيف ليها التوابل علشان تدينا نكهة مميزة.",
 "قطع من صدور الفراخ، رأس بصلة، فص ثوم، نصف باكيت معكرونة، كوب ونصف مية، سمنة.",
 "نحط السمنة في إناء التحضير لغاية ما تذوب وبعد كده نضيف عليها البصل ونقلب لغاية ما يحمر. نضيف قطع الفراخ المقطعة مكعبات ونستمر في التقليب. نضيف الثوم المدقوق والمعكرونة مع التقليب. بعد كده نصب عليهم المية ونسيبهم لغاية ما يستووا لمدة ١٥ دقيقة.",
 "شوربة", "recipe_4"),

    ("فراخ بالبصل", 
 "فراخ بالبصل هو طبق لذيذ وشهي، بنعمله باستخدام الفراخ والبصل والتوابل علشان يدينا نكهة مميزة.",
 "فراخة واحدة، ٣ بصيلات متوسطة الحجم، ٣ معالق كبيرة سمنة، خلاصة مرقة فراخ، بهارات حسب الرغبة.",
 "نقطع الفراخة قطع صغيرة ونتأكد إنها مغسولة كويس، وبعد كده نحطها في إناء الطبخ. نبشر البصل على الفراخ، ونضيف عليها السمنة، ونقلب كويس على النار وبعد كده نضيف عليها البهارات ومرقة الفراخ، ونقلب من وقت للتاني، لغاية ما البصل يوصل للون الذهبي، لمدة ١٥ دقيقة تقريبًا. نضيف ٤ أكواب مية على الفراخ ونسيبها تغلي لمدة نص ساعة لغاية ما القوام يتماسك. نقدمها مع طبق أرز أبيض وبالهناء والشفاء.",
 "اكلات رئيسية", "recipe_5")
]

# Insert the whole recipe as a single chunk
for doc in recipes_data:
    full_recipe = f"{doc[0]}\n{doc[1]}\n{doc[2]}\n{doc[3]}"
    collection.upsert(
        documents=[full_recipe],  # Full recipe as a single chunk
        ids=[f"{doc[5]}_full_recipe"],
        metadatas=[{"type": "recipe", "category": doc[4]}]  # Metadata for the full recipe
    )

print("Data has been successfully added to the 'recipes' collection.")

